---
title: Baltimore Crime Analysis
author: Antonio Holmes
date: '2019-03-30'
slug: atus-survey-analysis
categories:
  - data analysis
tags:
  - R
image:
  caption: ''
  focal_point: ''
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(lubridate)
library(scales)
library(janitor)
```

### The data

Violent crime in the United States has fallen over the last two decades. Even though the violent crime rate has been decreasing since 1990, The United States had the second highest prisoner rate, with 693 prisoners per 100,000 of the national population. And Baltimore, Maryland is infamous for its very high crime rates. According to Forbes, Baltimore is the seventh dangerous city in the United States. The violent crime rate is 1417 per 100.000 residents in a population of 626.848 people in 2017 so Baltimore is the one of the cities which is carrying high risk for local people.


crime <- read_csv("data/tidy_data/BPD_Part_1_Victim_Based_Crime_Data 2.csv")%>% clean_names()


crime <- crime %>% mutate(crime_date = mdy(crime_date))
    

crime_month <- crime %>%
  mutate(month = floor_date(crime_date, "month")) %>%
  group_by(month) %>% 
  summarize(n = n())
    

ggplot(crime_month, aes(month,n)) + geom_line() + ylab("Crime") + xlab("Years")

crime_month <- crime_month %>%
  filter(month != max(month))

ggplot(crime_month, aes(month,n)) + geom_line()
    
ggplot(crime_month, aes(month,n)) + geom_line() + scale_x_date(date_breaks = "6 month", labels = date_format("%Y %b")) + ylab("Crime") + xlab("Month/Year")
    
    

crime <- crime %>% mutate(crime_hour = hour(crime_time))
    

crime %>% group_by(crime_hour) %>%
  summarize(n=n()) %>% 
arrange(-n) %>% 
  rename("Hours" = crime_hour,"Crimes" = n)
  
    

crime %>%
  group_by(district) %>% 
  summarize(n = n()) %>%
  ggplot(aes(x = reorder(district,n),y = n)) + geom_bar(stat="identity") + coord_flip() + ylab("Crime") + xlab("District")



year <- crime %>%
  mutate(year = year(crime_date)) %>% 
  group_by(year) %>% 
  summarize(n = n()) %>% 
  ggplot(aes(x = year,y = n)) + geom_bar(stat="identity")
  
```{r}
crime %>%  mutate(year = year(crime_date)) %>% 
  group_by(district, year) %>%
  summarize(n = n()) %>%
  drop_na(district) %>%
  filter(year != 2017) %>% 
  ggplot(aes(x = year, y = n, color= district)) + geom_line() + ylab("Number of Crimes")
```
